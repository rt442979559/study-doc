import{_ as O,f as T,j as x,I as B,a2 as U,R as N,o as j,c as L,a as u,S as Q,b as _,w as v,h as $,a3 as J,r as E,d as h,a4 as q,a5 as H}from"./app.ab3d721a.js";const P=async()=>new Promise((l,f)=>{if(typeof AMap!="undefined")return l(AMap),!0;window._AMapSecurityConfig={securityJsCode:"eb942a91bf9b401f20b94d1120cc2015"};const c=document.createElement("script");c.src="https://webapi.amap.com/maps?v=1.4.15&key=d3b369f37bc25183a31cc7e3864000c6",document.head.appendChild(c),setTimeout(()=>{AMap&&l(AMap)},3e3),c.load=()=>{console.log(AMap,"AMap"),l(AMap)}});const G=l=>(q("data-v-55fbd3fa"),l=l(),H(),l),K={class:"map"},W=h("\u5730\u56FE\u9009\u70B9"),X=G(()=>u("div",{id:"container"},null,-1)),Y=G(()=>u("div",{id:"pickerBox"},[u("input",{id:"pickerInput",placeholder:"\u8F93\u5165\u5173\u952E\u5B57\u9009\u53D6\u5730\u70B9"}),u("div",{id:"poiInfo"})],-1)),Z={class:"dialog-footer"},ee=h("\u53D6\u6D88"),te=h("\u786E\u5B9A"),oe=T({__name:"GaodeMap",props:["visible","lonlat","mapOption"],emits:["update:visible","update:lonlat","getAddress"],setup(l,{emit:f}){const c=l,i=x({get:()=>c.visible,set:e=>f("update:visible",e)}),o=x({get:()=>c.lonlat,set:e=>f("update:lonlat",e)});let s=null,a=null,g=[],d=null;const b=window.AMapUI,A=B(""),r=B(""),S=async()=>{if(a=await P(),s=new a.Map("container",{zoom:18,viewMode:"3D",center:o.value||[120.5644,27.6025],pitch:50,rotation:35,resizeEnable:!0}),d=new a.Marker,s.plugin(["AMap.ToolBar","AMap.Scale","AMap.OverView","AMap.Geocoder"],()=>{s.addControl(new a.ToolBar),s.addControl(new a.Scale),s.addControl(new a.OverView),A.value=new a.Geocoder({radius:1e3})}),b&&b.loadUI(["misc/PoiPicker"],function(t){var n=new t({input:"pickerInput"});V(n)}),o.value&&o.value.length>0){const t={Q:o.value[1],R:o.value[0],lng:o.value[0],lat:o.value[1]};w(t),y(o.value)}D()},V=e=>{window.poiPicker=e,e.on("poiPicked",function(t){const n=t.item;w(n.location),r.value=n.address||n.name,d.setLabel({offset:new a.Pixel(1,0),content:r.value,direction:"top"})}),e.onCityReady(function(){e.suggest("\u7F8E\u98DF")})},D=()=>{s.on("click",e=>{const t={Q:e.lnglat.lat,R:e.lnglat.lng,lng:e.lnglat.lng,lat:e.lnglat.lat};w(t),y(g)})},w=e=>{s.remove(d),d.setMap(s),d.setPosition(e),s.setCenter(d.getPosition()),g=[e.lng,e.lat]},y=e=>{A.value.getAddress(e,(t,n)=>{t==="complete"&&n.regeocode&&(r.value=n.regeocode.formattedAddress,d.setLabel({offset:new a.Pixel(1,0),content:r.value,direction:"top"}))})};let m=null,p=null;const k=async()=>{a=await P(),p=new a.Marker,m=new a.Map("container-mini",{zoom:18,viewMode:"3D",center:o.value||[120.5644,27.6025],pitch:50,rotation:35,resizeEnable:!0}),o.value&&o.value.length>0&&(m.remove(p),p.setMap(m),p.setPosition([o.value[0],o.value[1]]),m.setCenter(p.getPosition()))};U(()=>{i.value&&S(),o.value&&k()}),N(async()=>{await k()});const R=()=>{o.value=g,i.value=!1,f("getAddress",r.value)},z=()=>{s.destroy()};return(e,t)=>{var C,I;const n=E("el-button"),F=E("el-dialog");return j(),L("div",K,[u("div",{id:"container-mini",style:Q({height:((C=l.mapOption)==null?void 0:C.height)||"200px",width:((I=l.mapOption)==null?void 0:I.width)||"200px"})},null,4),_(n,{onClick:t[0]||(t[0]=M=>i.value=!0)},{default:v(()=>[W]),_:1}),_(F,{top:"2.5%",width:"60%",modelValue:$(i),"onUpdate:modelValue":t[2]||(t[2]=M=>J(i)?i.value=M:null),"show-close":!1,"custom-class":"dialog_style",title:"\u5730\u56FE\u9009\u70B9",onClose:z,"destroy-on-close":!0},{footer:v(()=>[u("span",Z,[_(n,{onClick:t[1]||(t[1]=M=>i.value=!1)},{default:v(()=>[ee]),_:1}),_(n,{type:"primary",onClick:R},{default:v(()=>[te]),_:1})])]),default:v(()=>[X,Y]),_:1},8,["modelValue"])])}}});var ne=O(oe,[["__scopeId","data-v-55fbd3fa"],["__file","GaodeMap.vue"]]);export{ne as default};
